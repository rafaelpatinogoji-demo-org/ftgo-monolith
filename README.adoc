# ğŸ• FTGO Monolith - Food To Go Application

A complete monolithic Spring Boot application demonstrating a food delivery service. This is the monolithic version of the [FTGO application](https://github.com/microservices-patterns/ftgo-application) from the book [Microservices Patterns](https://microservices.io/book).

## ğŸš€ Quick Start

**TL;DR**: Just run this command and you're done!

```bash
./build-and-run-auto.sh
```

That's it! The script will:
- âœ… Detect your system architecture (ARM64/x86_64)
- âœ… Compile the Java application
- âœ… Build Docker images
- âœ… Start MySQL database
- âœ… Launch the application
- âœ… Show you the access URLs

## ğŸ“‹ Prerequisites

Before running the application, make sure you have:

### Required
- **Docker Desktop** - [Download here](https://www.docker.com/products/docker-desktop)
- **Java 8+** - Check with `java -version`

### Installation Commands (macOS)
```bash
# Install Java (if needed)
brew install openjdk@11

# Install Docker Desktop from the website above
# Or use: brew install --cask docker
```

## ğŸ—ï¸ Architecture Support

This project supports both:
- **ğŸ Apple Silicon (M1/M2/M3)** - ARM64 architecture
- **ğŸ’» Intel/AMD** - x86_64 architecture

The build script automatically detects your architecture and uses the appropriate configuration.

## ğŸŒ Access Your Application

Once running, you can access:

| Service | URL | Description |
|---------|-----|-------------|
| **Main Application** | http://localhost:8081 | FTGO web application |
| **Health Check** | http://localhost:8081/actuator/health | Application status |
| **Swagger UI** | http://localhost:8081/swagger-ui.html | API documentation |
| **MySQL Database** | localhost:3306 | Database (user: `mysqluser`, pass: `mysqlpw`) |

## ğŸ› ï¸ Manual Commands

If you prefer more control over individual steps:

```bash
# Compile the application
./gradlew :ftgo-application:assemble

# Build Docker images (ARM64)
docker-compose -f docker-compose-arm64.yml build

# Build Docker images (x86)
docker-compose -f docker-compose-x86.yml build

# Start services (ARM64)
docker-compose -f docker-compose-arm64.yml up -d

# Start services (x86)
docker-compose -f docker-compose-x86.yml up -d

# View logs
docker-compose -f docker-compose-arm64.yml logs -f  # ARM64
docker-compose -f docker-compose-x86.yml logs -f    # x86

# Stop services
docker-compose -f docker-compose-arm64.yml down     # ARM64
docker-compose -f docker-compose-x86.yml down       # x86
```

## ğŸ”§ Troubleshooting

### Port Already in Use
```bash
# Check what's using port 3306
lsof -i :3306

# Stop local MySQL if running
brew services stop mysql
```

### Permission Denied
```bash
# Make scripts executable
chmod +x *.sh
```

### Docker Issues
- Make sure Docker Desktop is running (look for ğŸ³ in your menu bar)
- Try restarting Docker Desktop
- Check available disk space

### Build Failures
```bash
# Clean and rebuild
./gradlew clean
./build-and-run-auto.sh
```

## ğŸ“ Project Structure

```
ftgo-monolith/
â”œâ”€â”€ ğŸš€ build-and-run-auto.sh          # Main script (auto-detects architecture)
â”œâ”€â”€ ğŸ“Š load-sample-data.sh             # Sample data loader
â”œâ”€â”€ ğŸ³ docker-compose-arm64.yml       # ARM64 configuration
â”œâ”€â”€ ğŸ³ docker-compose-x86.yml         # x86 configuration
â”œâ”€â”€ ğŸ“± ftgo-application/               # Main Spring Boot app
â”œâ”€â”€ ğŸ—„ï¸ mysql/                         # Database configuration & schemas
â”œâ”€â”€ ğŸ›ï¸ ftgo-order-service/            # Order management
â”œâ”€â”€ ğŸª ftgo-restaurant-service/       # Restaurant management
â”œâ”€â”€ ğŸšš ftgo-courier-service/          # Delivery management
â”œâ”€â”€ ğŸ‘¤ ftgo-consumer-service/         # Customer management
â”œâ”€â”€ ğŸ“‹ COMMANDS.md                     # Useful commands reference
â””â”€â”€ ğŸ“– README.adoc                     # This file
```

## ğŸ§ª Testing the Application

Once running, you can test the API endpoints:

```bash
# Check application health
curl http://localhost:8081/actuator/health

# Create a consumer
curl -X POST http://localhost:8081/consumers \
  -H "Content-Type: application/json" \
  -d '{"name": {"firstName": "John", "lastName": "Doe"}}'

# Get a consumer
curl http://localhost:8081/consumers/1

# View sample data (pre-loaded restaurants and couriers)
curl http://localhost:8081/restaurants
curl http://localhost:8081/couriers
```

### ğŸ—„ï¸ Database Schema

The application automatically creates all necessary tables on startup:
- **consumers** - Customer information
- **restaurants** - Restaurant details and menus  
- **orders** - Order management
- **courier** - Delivery personnel
- **courier_actions** - Delivery tracking
- **order_line_items** - Order details

Sample data is automatically loaded including:
- 3 sample couriers
- 3 sample restaurants with menu items
- Hibernate sequence table for ID generation

## ğŸ¯ What This Application Demonstrates

- **Monolithic Architecture**: Single deployable unit
- **Spring Boot**: Modern Java web framework
- **JPA/Hibernate**: Database ORM
- **MySQL**: Relational database
- **Docker**: Containerization
- **Multi-architecture Support**: ARM64 + x86_64
- **RESTful APIs**: HTTP-based services
- **Domain-Driven Design**: Business logic organization